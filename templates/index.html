{% extends "base.html" %}

{% block title %}Setup Interview - Mock Interview Practice{% endblock %}

{% block content %}
<div class="container">
    <div class="setup-container">
        <h2>üöÄ Setup Your Mock Interview</h2>
        <p class="setup-description">
            Configure your AI interviewer and upload relevant documents for a personalized interview experience.
        </p>

        <form action="/setup" method="post" enctype="multipart/form-data" class="setup-form">
            
            <!-- LLM Configuration Section -->
            <section class="form-section">
                <h3>ü§ñ AI Configuration</h3>
                
                <div class="form-group">
                    <label for="llm_provider">LLM Provider:</label>
                    <select name="llm_provider" id="llm_provider" required>
                        {% for provider in llm_providers %}
                        <option value="{{ provider }}" {% if provider == 'openai' %}selected{% endif %}>
                            {{ provider.title() }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="llm_model">Model:</label>
                    <select name="llm_model" id="llm_model" required>
                        <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                        <option value="gpt-4">GPT-4</option>
                        <option value="gpt-4o">GPT-4o</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="api_key">API Key (Optional):</label>
                    <input type="password" name="api_key" id="api_key" 
                           placeholder="Leave blank to use .env_local file">
                    <small class="form-help">üí° Will use OPENAI_API_KEY or ANTHROPIC_API_KEY from .env_local if empty. Not stored permanently.</small>
                </div>
            </section>

            <!-- Interview Configuration Section -->
            <section class="form-section">
                <h3>üéØ Interview Settings</h3>

                <div class="form-group">
                    <label for="interview_type">Interview Type:</label>
                    <select name="interview_type" id="interview_type" required>
                        {% for itype in interview_types %}
                        <option value="{{ itype }}">{{ itype.replace('_', ' ').title() }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="tone">Interviewer Tone:</label>
                    <select name="tone" id="tone" required>
                        {% for tone in tones %}
                        <option value="{{ tone }}" {% if tone == 'professional' %}selected{% endif %}>
                            {{ tone.title() }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="difficulty">Difficulty Level:</label>
                    <select name="difficulty" id="difficulty" required>
                        {% for diff in difficulties %}
                        <option value="{{ diff }}" {% if diff == 'medium' %}selected{% endif %}>
                            {{ diff.title() }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </section>

            <!-- Voice Settings Section -->
            <section class="form-section">
                <h3>üéôÔ∏è Voice Settings</h3>

                <div class="form-group">
                    <label for="tts_voice">Interviewer Voice:</label>
                    <select name="tts_voice" id="tts_voice" required>
                        <option value="alloy" selected>Alloy (Neutral, Clear)</option>
                        <option value="echo">Echo (Male, Confident)</option>
                        <option value="fable">Fable (British Accent)</option>
                        <option value="onyx">Onyx (Deep, Authoritative)</option>
                        <option value="nova">Nova (Young, Energetic)</option>
                        <option value="shimmer">Shimmer (Warm, Friendly)</option>
                    </select>
                    <small class="form-help">Choose the interviewer's voice personality (uses OpenAI TTS)</small>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" name="tts_enabled" id="tts_enabled">
                        Enable interviewer voice ($0.015 per 1K characters)
                    </label>
                    <small class="form-help">Uncheck to save costs - you can toggle during interview</small>
                </div>
            </section>

            <!-- Job Context Section -->
            <section class="form-section">
                <h3>üíº Job Context (Optional)</h3>

                <div class="form-group">
                    <label for="company_name">Company Name:</label>
                    <input type="text" name="company_name" id="company_name" 
                           placeholder="e.g., Google, Netflix, Startup Inc">
                </div>

                <div class="form-group">
                    <label for="role_title">Role Title:</label>
                    <input type="text" name="role_title" id="role_title" 
                           placeholder="e.g., Senior Data Scientist, ML Engineer">
                </div>
            </section>

            <!-- Custom Instructions Section -->
            <section class="form-section">
                <h3>üìù Custom Instructions (Optional)</h3>

                <div class="form-group">
                    <label for="custom_instructions">Additional Instructions for Interviewer:</label>
                    <textarea name="custom_instructions" id="custom_instructions" 
                              rows="4" 
                              placeholder="e.g., Focus on time series forecasting, emphasize healthcare domain experience, include system design questions, ask about team leadership..."></textarea>
                    <small class="form-help">Provide specific guidance to customize your interview focus and style.</small>
                </div>
            </section>

            <!-- Document Upload Section -->
            <section class="form-section">
                <h3>üìÑ Document Upload (Optional)</h3>

                <div class="form-group">
                    <label for="resume">Resume/CV:</label>
                    <input type="file" name="resume" id="resume" accept=".pdf,.txt,.doc,.docx">
                    <small class="form-help">Upload your resume for personalized questions about your background.</small>
                </div>

                <div class="form-group">
                    <label for="job_description">Job Description:</label>
                    <input type="file" name="job_description" id="job_description" accept=".pdf,.txt,.doc,.docx">
                    <small class="form-help">Upload the job posting for role-specific questions.</small>
                </div>
            </section>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                    üé¨ Start Interview
                </button>
            </div>

        </form>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Dynamic model selection based on provider
document.getElementById('llm_provider').addEventListener('change', function() {
    const provider = this.value;
    const modelSelect = document.getElementById('llm_model');
    
    // Clear existing options
    modelSelect.innerHTML = '';
    
    if (provider === 'openai') {
        const models = [
            {value: 'gpt-3.5-turbo', text: 'GPT-3.5 Turbo'},
            {value: 'gpt-4', text: 'GPT-4'},
            {value: 'gpt-4-turbo', text: 'GPT-4 Turbo'},
            {value: 'gpt-4o', text: 'GPT-4o'},
            {value: 'gpt-4o-mini', text: 'GPT-4o Mini'}
        ];
        models.forEach(model => {
            const option = document.createElement('option');
            option.value = model.value;
            option.textContent = model.text;
            modelSelect.appendChild(option);
        });
    } else if (provider === 'anthropic') {
        const models = [
            {value: 'claude-3-5-sonnet-20241022', text: 'Claude 3.5 Sonnet'},
            {value: 'claude-3-opus-20240229', text: 'Claude 3 Opus'},
            {value: 'claude-3-sonnet-20240229', text: 'Claude 3 Sonnet'},
            {value: 'claude-3-haiku-20240307', text: 'Claude 3 Haiku'}
        ];
        models.forEach(model => {
            const option = document.createElement('option');
            option.value = model.value;
            option.textContent = model.text;
            modelSelect.appendChild(option);
        });
    }
});

// Trigger initial model population
document.getElementById('llm_provider').dispatchEvent(new Event('change'));
</script>
{% endblock %}